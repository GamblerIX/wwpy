# 鸣潮服务器环境配置完整指南

本指南将帮助您一步步完成鸣潮服务器运行所需的全部环境配置，包括 Rust 编程环境、Protocol Buffers 编译器和 PostgreSQL 数据库。

## 📋 配置清单

在开始之前，请确保您需要安装以下三个核心组件：

* **Rust** - 用于编译服务器程序

* **Protocol Buffers (protoc)** - 用于处理网络通信协议

* **PostgreSQL** - 用于存储用户数据和游戏数据

***

## 🦀 第一步：安装 Rust 编程环境

### 下载和安装

1. **下载安装程序**

   * 访问链接下载：<https://static.rust-lang.org/rustup/dist/x86_64-pc-windows-msvc/rustup-init.exe>

2. **运行安装程序**

   * 双击下载的 `rustup-init.exe` 文件

   * 当出现安装选项时，直接按 **回车键** 选择默认配置

   * 耐心等待程序自动从官方源下载并安装所有组件

### 验证安装

安装完成后，打开命令提示符（按 Win+R，输入 cmd），输入以下命令验证：

```bash
rustc --version
```

如果显示版本信息，说明 Rust 安装成功！

***

## ⚙️ 第二步：安装 Protocol Buffers 编译器

### 自动安装（推荐）

1. **以管理员身份运行 PowerShell**

   * 按 Win+X，选择「Windows PowerShell (管理员)」

   * 或者按 Win+R，输入 `powershell`，然后按 Ctrl+Shift+Enter

2. **切换到项目目录**

   ```powershell
   cd "您的项目路径\wwpy\docs"
   ```

   例如：`cd "C:\Users\Administrator\Documents\GitHub\wwpy\docs"`

3. **执行安装脚本**

   ```powershell
   .\install_protoc.ps1
   ```

### 验证安装

安装完成后，在命令提示符中输入：

```bash
protoc --version
```

如果显示 `libprotoc 29.5` ，说明安装成功！

***

## 🐘 第三步：安装和配置 PostgreSQL 数据库

### 下载和安装数据库

1. **下载安装程序**

   * 访问链接：<https://get.enterprisedb.com/postgresql/postgresql-17.5-3-windows-x64.exe>

   * 下载 PostgreSQL 17.5 版本

2. **运行安装程序**

   * 双击下载的安装文件

   * 在安装过程中，当要求设置 postgres 用户密码时，请设置为：`Aa123456`

   * 其他选项保持默认，完成安装

### 配置数据库

安装完成后，需要创建项目专用的数据库和用户：

1. **打开命令提示符**

   * 按 Win+R，输入 `cmd` 并回车

2. **进入 PostgreSQL 安装目录**

   ```PowerShell
   cd C:\Program Files\PostgreSQL\17\bin
   ```

3. **连接到数据库**

   ```PowerShell
   psql -U postgres -h 127.0.0.1 -p 5432
   ```

   * 系统会提示输入密码，输入 `Aa123456` 并回车

   * 成功连接后会显示 `postgres=#` 提示符

4. **创建项目数据库**

   ```SQL
   CREATE DATABASE users;
   ```

   * 成功后会显示 `CREATE DATABASE`

5. **创建项目用户**

   ```SQL
   CREATE USER users WITH PASSWORD 'password';
   ```

   * 成功后会显示 `CREATE ROLE`

6. **切换到项目数据库**

   ```SQL
   \c users
   ```

   * 成功后会显示 `You are now connected to database "users" as user "postgres"`

7. **设置用户权限**
   依次执行以下命令：

   ```SQL
   GRANT CREATE, USAGE ON SCHEMA public TO users;
   ```

   ```SQL
   GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO users;
   ```

   ```SQL
   ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL PRIVILEGES ON TABLES TO users;
   ```

   <br />

   * 成功后分别会显示 `GRANT`,`GRANT`,`ALTER DEFAULT PRIVILEGES`

8. **退出数据库终端**

   ```SQL
   \q
   ```

### 数据库连接信息

配置完成后，项目将使用以下连接信息：

* **主机地址**：127.0.0.1:5432

* **数据库名**：users

* **用户名**：users

* **密码**：password

***

## ✅ 环境验证

完成所有安装后，请验证两个个组件都已正确安装：

```PowerShell
rustc --version
# 输出类似：rustc 1.88.0 (6b00bc388 2025-06-23)
```

```PowerShell
protoc --version
# 输出必须完全相同：libprotoc 29.5
```

## 🚨 常见问题

### Rust 安装问题

* 如果下载速度慢，可以考虑使用代理服务

* 安装过程中如果出现网络错误，可以重新运行安装程序

### Protoc 安装问题

* 确保以管理员权限运行 PowerShell

### PostgreSQL 配置问题

* 确保密码设置和填写正确（区分大小写）

* 如果连接失败，检查 PostgreSQL 服务是否正在运行

* 可以在服务管理器中查看 postgresql-x64-17 服务状态

## 🎉 配置完成

恭喜！您已经完成了鸣潮服务器运行所需的全部环境配置。现在可以返回主程序，开始下载源码和构建服务器了。

如果在配置过程中遇到任何问题，请仔细检查每个步骤，确保按照指南操作。大部分问题都可以通过重新执行相关步骤来解决。
